services:
  agent:
    build: .
    env_file: .env
    environment:
      - FA_DB_PATH=/app/state/agent.duckdb
      - FA_BACKUP_DIR=/app/state/backups
      - FA_LOG_DIR=/app/state/logs
      - FA_SERVER_PORT=8765
      - KALSHI_PRIVATE_KEY_PATH=/workspace/keys/private_key.pem
    volumes:
      - ./workspace/data:/workspace/data:ro
      - ./workspace/data:/app/state
      - ./workspace/analysis:/workspace/analysis
      - ./.git:/app/repo/.git
      - ./workspace/analysis:/app/repo/workspace/analysis
      - ~/.kalshi/private_key.pem:/workspace/keys/private_key.pem:ro
      - ~/.claude/.credentials.json:/root/.claude/.credentials.json:ro
      - claude-sessions:/root/.claude/projects
    ports:
      - "8765:8765"
    restart: unless-stopped
    stop_grace_period: 30s

volumes:
  claude-sessions:
